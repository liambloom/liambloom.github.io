<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Countdown</title>
	<link rel="stylesheet" href="./css/index.css">
	<script src="./js/changeLink.js"></script>
	<script src="./js/findDay.js"></script>
	<script src="./js/findYear.js"></script>
	<script src="./js/findLast.js"></script>
	<script src="./js/Readable.js"></script>
	<script src="./js/cssVarChange.js"></script>
	<script src="./js/Redirect.js"></script>
	<script src="./js/makeDropdown.js"></script>
	<script src="./js/countdown2.js"></script>
</head>
<body>
	<div id="menu">
	<h1>Pick a countdown...</h1>
	<p id="Labels">
		<a id="New Years Day"></a><br>
		<a id="Martin Luther King Jr. Day"></a><br>
		<a id="George Washington's Birthday"></a><br>
		<a id="Memorial Day"></a><br>
		<a id="Independence Day"></a><br>
		<a id="Labor Day"></a><br>
		<a id="Columbus Day"></a><br>
		<a id="Veterans Day"></a><br>
		<a id="Thanksgiving Day"></a><br>
		<a id="Christmas Day"></a><br>
		<a id="Test"></a><br>
	</p>
	<h1>...or make your own</h1>
	<form>
		Date:
		<select id="month" name=1>
			<option value=0>January</option>
			<option value=1>Febuary</option>
			<option value=2>March</option>
			<option value=3>April</option>
			<option value=4>May</option>
			<option value=5>June</option>
			<option value=6>July</option>
			<option value=7>August</option>
			<option value=8>September</option>
			<option value=9>October</option>
			<option value=10>November</option>
			<option value=11>December</option>
		</select>
		<select id="day" name=2>
		</select>
		, 
		<select id="year" name=0>
		</select>
		<br>
		Time:
		<select id="hour" name=3>
			<option value=0>24</option>
		</select>
		:
		<select id="minute" name=4>
		</select>
		<br>
		Name of event:
		<input type="text" name=7 id=until >
		<br>
		Message to display when timer reaches zero:
		<input type="text" name=8 id=message >
		<br>
		Background when timer reaches zero:
		<select id="background" name=9 onchange="document.getElementById('end').src = './img/' + this.value + '.gif'">
			<option value="fireworks">Fireworks</option>
			<option value="christmasTree">Christmas Tree</option>
			<option value="flag">American Flag</option>
			<option value="ship">Ship Sailing</option>
			<option value="turkey">Snoopy's Thanksgiving</option>
			<option value="birthday">Birthday Cake</option>
		</select>
		<img id="end" src="./img/fireworks.gif" style="height: 40px">
		<br>
		Hourglass in background:
 		<select id="hourglassselect" name=10 onchange="document.body.style.backgroundImage = 'url(./img/'+ this.value +'.gif)'; Readable()">
			<option value="Hourglass">Default</option>
			<option value="Hourglass2">Simple</option>
			<option value="Hourglass3">Swirly</option>
			<option value="HourglassChristmas">Christmasy</option>
		</select>
		<br>
		<input type="submit" value="Go!">
	</form>
	</div>
	<div id="main">
	<p id="t" class=number>
		<span id="dn" class=number></span>
		<span id="dl" class=label></span>
		<span id="hn" class=number></span>
		<span id="hl" class=label></span>
		<span id="mn" class=number></span>
		<span id="ml" class=label></span>
		<span id="sn" class=number></span>
		<span id="un" class=smallNumber></span>
		<span id="sl" class=label></span>
		<br>
		<span class=label>until</span>
		<span id="to" class=number></span>
	</p>
	</div>
	<script>
		try{
			var urlinfo = new URLSearchParams(window.location.search);
			if (urlinfo == ""){
				document.getElementById("main").innerHTML = "";
				var n = new Date();
				changeLink("New Years Day", "0=" + findYear(n.getFullYear(), n.getMonth(), 0) + "&7=" + findYear(n.getFullYear(), n.getMonth(), 0) + "&8=Happy+New+Year");
				changeLink("Martin Luther King Jr. Day", "0=" + findYear(n.getFullYear(), n.getMonth(), 0) + "&1=0&2=" + findDay(findYear(n.getFullYear(), n.getMonth(), 0), 0, 1, 3) + "&7=Martin+Luther+King+Jr.+Day&8=Happy+Martin+Luther+King+Jr.+Day");
				changeLink("George Washington's Birthday", "0=" + findYear(n.getFullYear(), n.getMonth(), 1) + "&1=1&2=" + findDay(findYear(n.getFullYear(), n.getMonth(),  1), 1, 1, 3) + "&7=Presidents'+Day&8=Happy+Presidents'+Day");
				changeLink("Memorial Day", "0=" + findYear(n.getFullYear(), n.getMonth(), 4) + "&1=4&2=" + findLast(findYear(n.getFullYear(), n.getMonth(), 4), 4, 1) + "&7=Memorial+Day&8=Never+Forget&9=flag");
				changeLink("Independence Day", "0=" + findYear(n.getFullYear(), n.getMonth(), 6) + "&1=6&2=4&7=Independence+Day&8=Happy+Independence+Day");
				changeLink("Labor Day", "0=" + findYear(n.getFullYear(), n.getMonth(), 8) + "&1=8&2=" + findDay(findYear(n.getFullYear(), n.getMonth(), 8), 8, 1, 1) + "&7=Labor+Day&8=Happy+Labor+Day");
				changeLink("Columbus Day", "0=" + findYear(n.getFullYear(), n.getMonth(), 9) + "&1=9&2=" + findDay(findYear(n.getFullYear(), n.getMonth(), 9), 9, 1, 2) + "&7=Columbus+Day&8=Happy+Columbus+Day&9=ship");
				changeLink("Veterans Day", "0=" + findYear(n.getFullYear(), n.getMonth(), 10) + "&1=10&2=11&7=Veterans+Day&8=Never+Forget&9=flag");
				changeLink("Thanksgiving Day", "0=" + findYear(n.getFullYear(), n.getMonth(), 10) + "&1=10&2=" + findDay(findYear(n.getFullYear(), n.getMonth, 10), 10, 4, 4) + "&7=Thanksgiving&8=Happy+Thanksgiving&9=turkey");
				changeLink("Christmas Day", "0=" + findYear(n.getFullYear(), n.getMonth(), 11) + "&1=11&2=25&7=Christmas&8=Merry+Christmas&9=christmasTree");
				changeLink("Test", "0=" + n.getFullYear() + "&1=" + n.getMonth() + "&2=" + n.getDate() + "&3=" + n.getHours() + "&4=" + n.getMinutes() + "&5=" + (n.getSeconds() + 10) + "&7=Results&8=Now");
				makeDropdown("day", 1, 31, 1);
				makeDropdown("year", n.getFullYear(), n.getFullYear() + 5, 1);
				makeDropdown("hour", 1, 23, 1);
				makeDropdown("minute", 0, 59, 2);
			}else{
				document.getElementById("menu").innerHTML = "";
				var info = [1970, 0, 1, 0, 0, 0, 0, "Something Happens", "Something Happened", "fireworks", "Hourglass"];
				var urlstuff = new URLSearchParams(window.location.search);
				var entries = urlstuff.entries();
				try{
					var pair;
					for(pair of entries) {
						info[pair[0]] = pair[1];
					}
				}catch(err){
					for(var i=0; i<(entries.length/2); i++){
						info[entries[i*2]] = entries[(i*2)+1];
					}
				}
				setInterval(function() {
					countdown2(info[0], info[1], info[2], info[3], info[4], info[5], info[6], info[7], info[8], 'url("./img/' + info[9] + '.gif")');
				}, 1);
				document.body.style.backgroundImage = "url(\"./img/" + info[10] + ".gif\")";
				window.addEventListener('load', function() {Readable();}, false);
				window.addEventListener('load', function() {
					if(document.getElementById("New Years Day").innerHTML == ""){
						Redirect("Error: Links did not load");
					}
				}, false);
			}
			
			try{
				window.addEventListener('load', function() {
					if(!(CSS.supports('color', 'var(--fake-var)'))){
						Redirect("Error: CSS variables are not supported");
					}
				}, false);
			}catch(err){
					Redirect("Error: CSS variables are not supported");
				}
		}catch(err){
			Redirect(err);
		}
	</script>
</body>
</html>