<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Beta Countdown</title>
	<link rel="stylesheet" href="./css/index.css">
	<script src="./js/findDay.js"></script>
	<script src="./js/findYear.js"></script>
	<script src="./js/findLast.js"></script>
	<script src="./js/Readable.js"></script>
	<script src="./js/cssVarChange.js"></script>
	<script src="./js/Redirect.js"></script>
	<script src="./js/makeDropdown.js"></script>
	<script src="./js/destroy.js"></script>
	<script src="./js/linkAdd.js"></script>
	<script src="./js/countdownHandler.js"></script>
	<script src="./js/countdown2.js"></script>
</head>
<body>
	<div id="hourglassMenu" class="popup">
		<div class="x" onclick="destroy('hourglassMenu')">
			×
		</div>
		Pick an hourglass for the background:
		<br>
		<select id="hourglassselect" name=5 onchange="document.body.style.backgroundImage = 'url(./img/'+ this.value +'.gif)'; Readable()">
			<option value="Hourglass">Default</option>
			<option value="Hourglass2">Simple</option>
			<option value="Hourglass3">Swirly</option>
			<option value="HourglassChristmas">Christmasy</option>
		</select>
		<br>
		<input type="button" value="Set Background" onclick="" id="hourglassSubmit">
	</div>
	<div class="bottom warning" id="betaWarning">
		<div class="x" onclick="destroy('betaWarning')">
			×
		</div>
		WARNING: This page is in beta. Some parts may not function as intended
		<button class="warning" onclick="destroy('betaWarning')" style="border-radius: 4px">Got It!</button>
		<button class="warning" onclick="window.location.assign('./index.html')" style="border-radius: 4px">Go to Stable Release</button>
	</div>
	<div id="menu">
	<h1>Pick a countdown...</h1>
	<p id="Labels">
		<a id="NewYearsDay">New Years Day</a><br>
		<a id="MartinLutherKingJrDay">Martin Luther King Jr. Day</a><br>
		<a id="GeorgeWashingtonsBirthday">George Washington's Birthday</a><br>
		<a id="MemorialDay">Memorial Day</a><br>
		<a id="IndependenceDay">Independence Day</a><br>
		<a id="LaborDay">Labor Day</a><br>
		<a id="ColumbusDay">Columbus Day</a><br>
		<a id="VeteransDay">Veterans Day</a><br>
		<a id="ThanksgivingDay">Thanksgiving Day</a><br>
		<a id="ChristmasDay">Christmas Day</a><br>
		<a id="Test">Test</a><br>
	</p>
	<h1>...or make your own</h1>
	<form>
		Date:
		<input type="date" name=0>
		<br>
		Time:
		<input type="time" name=1>
		<br>
		Name of event:
		<input type="text" name=4>
		<br>
		Message to display when timer reaches zero:
		<input type="text" name=5>
		<br>
		Background when timer reaches zero:
		<select id="background" name=6 onchange="document.getElementById('end').src = './img/' + this.value + '.gif'">
			<option value="fireworks">Fireworks</option>
			<option value="christmasTree">Christmas Tree</option>
			<option value="flag">American Flag</option>
			<option value="ship">Ship Sailing</option>
			<option value="turkey">Snoopy's Thanksgiving</option>
			<option value="birthday">Birthday Cake</option>
		</select>
		<img id="end" src="./img/fireworks.gif" style="height: 40px">
		<br>
		<input type="hidden" id="hourglassSave" name=7>
		<input type="submit" value="Go!">
	</form>
	</div>
	<div id="main">
	<p id="t" class=number>
		<span id="dn" class=number></span>
		<span id="dl" class=label></span>
		<span id="hn" class=number></span>
		<span id="hl" class=label></span>
		<span id="mn" class=number></span>
		<span id="ml" class=label></span>
		<span id="sn" class=number></span>
		<span id="un" class=smallNumber></span>
		<span id="sl" class=label></span>
		<br>
		<span class=label>until</span>
		<span id="to" class=number></span>
	</p>
	</div>
	<script>
		try{
			var urlinfo = new URLSearchParams(window.location.search);
			var info = ["0-1-1970", "00:00", 0, 0, "Something Happens", "Something Happened", "fireworks", undefined];
			var urlstuff = new URLSearchParams(window.location.search);
			var entries = urlstuff.entries();
			try{
				var pair;
				for(pair of entries) {
					info[pair[0]] = pair[1];
				}
			}catch(err){
				for(var i=0; i<(entries.length/2); i++){
					info[entries[i*2]] = entries[(i*2)+1];
				}
			}
			if (urlinfo == ""){
				destroy("main")
				var n = new Date();
				document.getElementById("NewYearsDay").href = "?0=" + findYear(n.getFullYear(), n.getMonth(), 0) + "-01-01&4=" + findYear(n.getFullYear(), n.getMonth(), 0) + "&5=Happy+New+Year";
				document.getElementById("MartinLutherKingJrDay").href = "?0=" + findYear(n.getFullYear(), n.getMonth(), 0) + "-01-" + findDay(findYear(n.getFullYear(), n.getMonth(), 0), 0, 1, 3) + "&4=Martin+Luther+King+Jr.+Day&5=Happy+Martin+Luther+King+Jr.+Day";
				document.getElementById("GeorgeWashingtonsBirthday").href = "?0=" + findYear(n.getFullYear(), n.getMonth(), 1) + "-02-" + findDay(findYear(n.getFullYear(), n.getMonth(),  1), 1, 1, 3) + "&4=Presidents'+Day&5=Happy+Presidents'+Day";
				document.getElementById("MemorialDay").href = "?0=" + findYear(n.getFullYear(), n.getMonth(), 4) + "-05-" + findLast(findYear(n.getFullYear(), n.getMonth(), 4), 4, 1) + "&4=Memorial+Day&5=Never+Forget&6=flag";
				document.getElementById("IndependenceDay").href = "?0=" + findYear(n.getFullYear(), n.getMonth(), 6) + "-07-04&4=Independence+Day&5=Happy+Independence+Day";
				document.getElementById("LaborDay").href = "?0=" + findYear(n.getFullYear(), n.getMonth(), 8) + "-09-" + findDay(findYear(n.getFullYear(), n.getMonth(), 8), 8, 1, 1) + "&4=Labor+Day&5=Happy+Labor+Day";
				document.getElementById("ColumbusDay").href = "?0=" + findYear(n.getFullYear(), n.getMonth(), 9) + "-10-" + findDay(findYear(n.getFullYear(), n.getMonth(), 9), 9, 1, 2) + "&4=Columbus+Day&5=Happy+Columbus+Day&6=ship";
				document.getElementById("VeteransDay").href = "?0=" + findYear(n.getFullYear(), n.getMonth(), 10) + "-11-11&4=Veterans+Day&5=Never+Forget&6=flag";
				document.getElementById("ThanksgivingDay").href = "?0=" + findYear(n.getFullYear(), n.getMonth(), 10) + "-11-" + findDay(findYear(n.getFullYear(), n.getMonth, 10), 10, 4, 4) + "&4=Thanksgiving&5=Happy+Thanksgiving&6=turkey";
				document.getElementById("ChristmasDay").href = "?0=" + findYear(n.getFullYear(), n.getMonth(), 11) + "-12-25&4=Christmas&5=Merry+Christmas&6=christmasTree";
				document.getElementById("Test").href = "?0=" + n.getFullYear() + "-" + (n.getMonth() + 1) + "-" + n.getDate() + "&1=" + n.getHours() + ":" + n.getMinutes() + "&2=" + (n.getSeconds() + 15) + "&4=Results&5=Now";
				window.addEventListener('load', function() {
					if(document.getElementById("NewYearsDay").href == ""){
						Redirect("Error: Links did not load");
					}
				}, false);
			}else{
				destroy("menu")
				setInterval(function() {
					countdownHandler(info[0], info[1], info[2], info[3], info[4], info[5], 'url("./img/' + info[6] + '.gif")');
				}, 1);
				document.body.style.backgroundImage = "url(\"./img/" + info[7] + ".gif\")";
				window.addEventListener('load', function() {Readable();}, false);
				if(info[7] != undefined && info[7] != ""){
					destroy("hourglassMenu")
				}
			}
				try{
					var linkslist = ["NewYearsDay", "MartinLutherKingJrDay", "GeorgeWashingtonsBirthday", "MemorialDay", "IndependenceDay", "LaborDay", "ColumbusDay", "VeteransDay", "ThanksgivingDay", "ChristmasDay", "Test"]
					document.getElementById("hourglassSubmit").onclick = function() {
						if (document.getElementById('hourglassSave')) {
							document.getElementById('hourglassSave').value = document.getElementById("hourglassselect").value
							linkAdd(linkslist, 11, "&7=" + document.getElementById("hourglassselect").value);
						}else{
							window.location.assign("?" + urlinfo + "&7=" + document.getElementById("hourglassselect").value);
						}
					destroy('hourglassMenu')
					}
				}catch(err){
					
				}
			try{
				window.addEventListener('load', function() {
					if(!(CSS.supports('color', 'var(--fake-var)'))){
						Redirect("Error: CSS variables are not supported");
					}
				}, false);
			}catch(err){
					Redirect("Error: CSS variables are not supported");
			}
		}catch(err){
			if(navigator.userAgent.indexOf("Safari") > -1 && !(navigator.userAgent.indexOf('Chrome') > -1)){
				window.location.assign("./safari.html")
			}else{
				Redirect(err)
			}
		}
	</script>
</body>
</html>